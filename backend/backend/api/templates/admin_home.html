<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

<!-- Navbar -->
<nav class="navbar navbar-dark bg-primary">
    <div class="container">
        <span class="navbar-brand">Admin Dashboard</span>

        <a href="{% url 'admin_logout' %}" class="btn btn-light">
            Logout
        </a>
    </div>
</nav>

<!-- Content -->
<div class="container mt-5">

    <!-- Stats -->
    <div class="row mb-5">

        <div class="col-md-4">
            <div class="card shadow p-3">
                <h5>Total Students</h5>
                <p>{{ student_count }}</p>
                 <a href="{% url 'add_student' %}" class="btn btn-primary">
            Add Students
        </a>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card shadow p-3">
                <h5>Total Courses</h5>
                <p>{{ course_count }}</p>
                <a href="{% url 'add_courses' %}" class="btn btn-primary">
                    Add Courses
                </a>
            </div>
           
        </div>
        

    </div>
    <!-- search dar -->
     <form method="GET" class="mb-4 col-md-6 mx-auto">
    <div class="input-group">
        <input type="text"
               name="q"
               class="form-control"
               placeholder="Search by username or email..."
               value="{{ query }}">

        <button class="btn btn-primary" type="submit">
            Search
        </button>
        <button href="{% url 'admin_home' %}" class="btn btn-secondary ">
    Reset
        </button>
    </div>
    


</form>
<a href="{% url 'course_list' %}" class="btn btn-primary mt-2">course list</a>
<a href="{% url 'assigned_courses_list' %}" class="btn btn-primary mt-2">Assigned Courses</a>

    <!-- Student Listing -->
    <h3 class="mb-3">Students</h3>

  <table class="table table-striped table-hover align-middle">
    <thead class="table-dark">
        <tr>
            <th>#</th>
            <th>Username</th>
            <th>Email</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for student in students %}
        <tr>
            <td>{{ forloop.counter }}</td>
            <td>{{ student.user.username }}</td>
            <td>{{ student.user.email }}</td>

            <td>
                {% if student.user.is_active %}
                    <span class="badge bg-success">Active</span>
                {% else %}
                    <span class="badge bg-danger">Blocked</span>
                {% endif %}
            </td>

            <td>
                <!-- Block / Unblock -->
                <a href="{% url 'toggle_student_status' student.id %}"
                   class="btn btn-sm {% if student.user.is_active %}btn-warning{% else %}btn-success{% endif %}">
                    {% if student.user.is_active %}Block{% else %}Unblock{% endif %}
                </a>

                <!-- Delete -->
                <a href="{% url 'delete_student' student.id %}"
                   class="btn btn-sm btn-danger"
                   onclick="return confirm('Are you sure you want to delete this student?');">
                    Delete
                </a>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5" class="text-center">No students found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

</div>

</body>
</html>